{"ast":null,"code":"import _regeneratorRuntime from\"/Users/noerios/Desktop/REACT BLOG/byenoe-blog/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/noerios/Desktop/REACT BLOG/byenoe-blog/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/noerios/Desktop/REACT BLOG/byenoe-blog/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect,useContext}from\"react\";import{Link,useLocation}from\"react-router-dom\";import\"./singlepost.css\";import axios from\"axios\";import{Context}from\"../../context/Context\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SinglePost=function SinglePost(){var location=useLocation();var path=location.pathname.split(\"/\")[2];var _useState=useState({}),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var PF=\"http://localhost:5000/images/\";var _useContext=useContext(Context),user=_useContext.user;var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),title=_useState4[0],setTitle=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),desc=_useState6[0],setDesc=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),updateMode=_useState8[0],setUpdateMode=_useState8[1];useEffect(function(){var getPost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/posts/\"+path);case 2:res=_context.sent;setPost(res.data);setTitle(res.data.title);setDesc(res.data.desc);case 6:case\"end\":return _context.stop();}}},_callee);}));return function getPost(){return _ref.apply(this,arguments);};}();getPost();},[path]);var handleDelete=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.delete(\"/posts/\".concat(post._id),{data:{username:user.username}});case 3:window.location.replace(\"/\");_context2.next=8;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);case 8:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return function handleDelete(){return _ref2.apply(this,arguments);};}();var handleUpdate=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.put(\"/posts/\".concat(post._id),{username:user.username,title:title,desc:desc});case 3:setUpdateMode(false);_context3.next=8;break;case 6:_context3.prev=6;_context3.t0=_context3[\"catch\"](0);case 8:case\"end\":return _context3.stop();}}},_callee3,null,[[0,6]]);}));return function handleUpdate(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"singlePost\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostWrapper\",children:[post.photo&&/*#__PURE__*/_jsx(\"img\",{src:PF+post.photo,alt:\"\",className:\"singlePostImg\"}),updateMode?/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:title,className:\"singlePostTitleInput\",autoFocus:true,onChange:function onChange(e){return setTitle(e.target.value);}}):/*#__PURE__*/_jsxs(\"h1\",{className:\"singlePostTitle\",children:[title,post.username===(user===null||user===void 0?void 0:user.username)&&/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostEdit\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"singlePostIcon far fa-edit\",onClick:function onClick(){return setUpdateMode(true);}}),/*#__PURE__*/_jsx(\"i\",{className:\"singlePostIcon far fa-trash-alt\",onClick:handleDelete})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostInfo\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"singlePostAuthor\",children:[\"Author:\",/*#__PURE__*/_jsx(Link,{className:\"link\",to:\"/?user=\".concat(post.username),children:/*#__PURE__*/_jsx(\"b\",{children:post.username})})]}),/*#__PURE__*/_jsx(\"span\",{className:\"singlePostDate\",children:new Date(post.createdAt).toDateString()})]}),updateMode?/*#__PURE__*/_jsx(\"textarea\",{className:\"singlePostDescInput\",value:desc,onChange:function onChange(e){return setDesc(e.target.value);}}):/*#__PURE__*/_jsx(\"p\",{className:\"singlePostDesc\",children:desc}),updateMode&&/*#__PURE__*/_jsx(\"button\",{className:\"singlePostButton\",onClick:handleUpdate,children:\"Update\"})]})});};export default SinglePost;","map":{"version":3,"sources":["/Users/noerios/Desktop/REACT BLOG/byenoe-blog/client/src/components/singlePost/SinglePost.jsx"],"names":["useState","useEffect","useContext","Link","useLocation","axios","Context","SinglePost","location","path","pathname","split","post","setPost","PF","user","title","setTitle","desc","setDesc","updateMode","setUpdateMode","getPost","get","res","data","handleDelete","delete","_id","username","window","replace","handleUpdate","put","photo","e","target","value","Date","createdAt","toDateString"],"mappings":"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","sourcesContent":["import { useState, useEffect, useContext } from \"react\";\nimport { Link, useLocation } from \"react-router-dom\";\nimport \"./singlepost.css\";\nimport axios from \"axios\";\nimport { Context } from \"../../context/Context\";\n\nconst SinglePost = () => {\n    const location = useLocation()\n    const path = location.pathname.split(\"/\")[2];\n    const [post, setPost] = useState({});\n    const PF = \"http://localhost:5000/images/\";\n    const {user} = useContext(Context);\n    const [title, setTitle] = useState(\"\");\n    const [desc, setDesc] = useState(\"\");\n    const [updateMode, setUpdateMode] = useState(false);\n\n\n    useEffect(() => {\n        const getPost = async () =>{\n            const res = await axios.get(\"/posts/\" + path);\n            setPost(res.data)\n            setTitle(res.data.title)\n            setDesc(res.data.desc)\n        };\n        getPost()\n    }, [path]);\n\n    const handleDelete = async () =>{\n        try{\n            await axios.delete(`/posts/${post._id}`, {\n                data: { username:user.username },\n            });\n            window.location.replace(\"/\");\n        } catch (err){}\n    };\n\n    const handleUpdate = async ()=>{\n        try{\n            await axios.put(`/posts/${post._id}`, {\n                username: user.username, \n                title, \n                desc,\n            });\n            setUpdateMode(false)\n        } catch (err){}\n    }\n\n    return (\n        <div className=\"singlePost\">\n            <div className=\"singlePostWrapper\">\n                {post.photo && (\n                    <img src={PF + post.photo} alt=\"\" className=\"singlePostImg\"/>\n                )}\n                {updateMode ? (\n                    <input \n                        type=\"text\" \n                        value={title} \n                        className=\"singlePostTitleInput\"\n                        autoFocus\n                        onChange={(e)=>setTitle(e.target.value)}\n                    />\n                    ) : (\n                        <h1 className=\"singlePostTitle\">\n                    {title}\n                    {post.username === user?.username &&(\n                        <div className=\"singlePostEdit\">\n                        <i className=\"singlePostIcon far fa-edit\" onClick={()=>setUpdateMode(true)}></i>\n                        <i className=\"singlePostIcon far fa-trash-alt\" onClick={handleDelete}></i>\n                    </div>\n                    )}\n                </h1>\n                    )\n                }\n                \n                <div className=\"singlePostInfo\">\n                    <span className=\"singlePostAuthor\">\n                        Author:  \n                        <Link className=\"link\" to={`/?user=${post.username}`}>\n                            <b>{post.username}</b>\n                        </Link>\n                        </span>\n                    <span className=\"singlePostDate\">{new Date(post.createdAt).toDateString()}</span>\n                </div>\n                {updateMode ? (\n                    <textarea \n                        className=\"singlePostDescInput\" \n                        value={desc} \n                        onChange={(e)=>setDesc(e.target.value)}\n                    />\n                ) : (\n                <p className=\"singlePostDesc\">{desc}</p>\n                )}\n                {updateMode && (\n                    <button className=\"singlePostButton\" onClick={handleUpdate}>\n                        Update</button>\n                )}\n            </div>\n        </div>\n    );\n}\n\nexport default SinglePost;\n"]},"metadata":{},"sourceType":"module"}